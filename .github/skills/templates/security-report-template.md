# 安全檢查報告

---

## 報告資訊

**專案名稱**: [專案名稱]
**掃描時間**: [日期時間]
**掃描範圍**: [目錄或檔案路徑]
**報告產生者**: Claude Code Security Skills
**報告版本**: 1.0

---

## 執行摘要

### 總體評分

🔴 **安全等級**: [Critical / High / Medium / Low / Good]

### 發現的問題統計

| 嚴重程度 | 數量 | 百分比 |
|---------|------|--------|
| 🔴 Critical (嚴重) | [數量] | [%] |
| 🟠 High (高) | [數量] | [%] |
| 🟡 Medium (中) | [數量] | [%] |
| 🔵 Low (低) | [數量] | [%] |
| ⚪ Info (資訊) | [數量] | [%] |
| **總計** | **[總數]** | **100%** |

### 問題分類

```mermaid
pie title 問題類別分布
    "注入攻擊" : [數量]
    "身份驗證" : [數量]
    "授權問題" : [數量]
    "敏感資料洩漏" : [數量]
    "配置錯誤" : [數量]
    "加密問題" : [數量]
    "其他" : [數量]
```

### 風險趨勢

| 檢查項目 | 狀態 | 說明 |
|---------|------|------|
| OWASP Top 10 漏洞 | [✅ / ⚠️ / ❌] | [說明] |
| 敏感資料洩漏 | [✅ / ⚠️ / ❌] | [說明] |
| 依賴套件漏洞 | [✅ / ⚠️ / ❌] | [說明] |
| 安全配置 | [✅ / ⚠️ / ❌] | [說明] |
| 程式碼品質 | [✅ / ⚠️ / ❌] | [說明] |

---

## 詳細發現

### 1. Critical (嚴重) 級別問題

#### [CRITICAL-001] [問題標題]

**檔案位置**: `[檔案路徑:行號]`

**漏洞類型**: [SQL Injection / RCE / Authentication Bypass / 等]

**CVE / CWE 編號**: [如適用]

**問題描述**:
[詳細描述問題的本質和影響範圍]

**程式碼片段**:
```[語言]
[有問題的程式碼]
```

**風險評估**:
- **機密性**: [High / Medium / Low]
- **完整性**: [High / Medium / Low]
- **可用性**: [High / Medium / Low]
- **可利用性**: [容易 / 中等 / 困難]
- **影響範圍**: [全系統 / 模組 / 功能]

**潛在影響**:
- [影響 1]
- [影響 2]
- [影響 3]

**修復建議**:

**優先級**: ⚡ 立即修復

**建議方案**:
```[語言]
[修復後的程式碼]
```

**驗證方式**:
1. [驗證步驟 1]
2. [驗證步驟 2]
3. [驗證步驟 3]

**參考資料**:
- [OWASP / CWE / CVE 連結]
- [相關技術文件]

---

### 2. High (高) 級別問題

#### [HIGH-001] [問題標題]

**檔案位置**: `[檔案路徑:行號]`

**漏洞類型**: [XSS / CSRF / 敏感資料洩漏 / 等]

**CVE / CWE 編號**: [如適用]

**問題描述**:
[詳細描述]

**程式碼片段**:
```[語言]
[有問題的程式碼]
```

**風險評估**:
- **CVSS 分數**: [分數] ([評級])
- **可利用性**: [容易 / 中等 / 困難]
- **影響範圍**: [說明]

**潛在影響**:
[影響說明]

**修復建議**:

**優先級**: 🔥 高優先級 (建議 7 天內修復)

**建議方案**:
```[語言]
[修復後的程式碼]
```

**驗證方式**:
[驗證步驟]

**參考資料**:
[連結]

---

### 3. Medium (中) 級別問題

#### [MEDIUM-001] [問題標題]

**檔案位置**: `[檔案路徑:行號]`

**漏洞類型**: [類型]

**問題描述**:
[描述]

**程式碼片段**:
```[語言]
[程式碼]
```

**修復建議**:

**優先級**: ⚠️ 中優先級 (建議 30 天內修復)

**建議方案**:
```[語言]
[修復程式碼]
```

---

### 4. Low (低) 級別問題

#### [LOW-001] [問題標題]

**檔案位置**: `[檔案路徑:行號]`

**問題描述**:
[描述]

**修復建議**:
[建議]

**優先級**: 📌 低優先級 (可在下個版本修復)

---

### 5. Info (資訊) 級別

#### [INFO-001] [最佳實踐建議]

**描述**:
[建議內容]

**優先級**: 💡 建議改進

---

## 依賴套件漏洞

### 已知漏洞清單

| 套件名稱 | 版本 | 漏洞 | 嚴重程度 | 修復版本 |
|---------|------|------|---------|---------|
| [套件] | [版本] | [CVE] | [Critical/High/Medium/Low] | [版本] |
| [套件] | [版本] | [CVE] | [Critical/High/Medium/Low] | [版本] |

### 更新建議

```bash
# Frontend (Node.js)
cd frontend
pnpm update [套件名稱]@[版本]

# Backend (Go)
cd backend
go get -u [套件路徑]@[版本]
go mod tidy
```

---

## 安全配置檢查

### 網路安全

| 項目 | 狀態 | 備註 |
|-----|------|------|
| HTTPS 強制 | [✅ / ❌] | [備註] |
| TLS 版本 | [✅ / ❌] | [最低版本] |
| HSTS | [✅ / ❌] | [設定值] |
| Certificate Pinning | [✅ / ❌] | [備註] |

### HTTP Security Headers

| Header | 狀態 | 設定值 | 建議 |
|--------|------|--------|------|
| Content-Security-Policy | [✅ / ❌] | [值] | [建議] |
| X-Frame-Options | [✅ / ❌] | [值] | [建議] |
| X-Content-Type-Options | [✅ / ❌] | [值] | [建議] |
| Referrer-Policy | [✅ / ❌] | [值] | [建議] |
| Permissions-Policy | [✅ / ❌] | [值] | [建議] |

### CORS 配置

| 項目 | 狀態 | 備註 |
|-----|------|------|
| 允許來源 | [✅ / ❌] | [白名單或 *] |
| 允許方法 | [✅ / ❌] | [方法列表] |
| Credentials | [✅ / ❌] | [true/false] |

### Cookie 安全

| 項目 | 狀態 | 備註 |
|-----|------|------|
| httpOnly | [✅ / ❌] | [Cookie 名稱] |
| secure | [✅ / ❌] | [Cookie 名稱] |
| sameSite | [✅ / ❌] | [strict/lax/none] |
| Cookie Prefix | [✅ / ❌] | [__Secure- / __Host-] |

---

## 合規性檢查

### OWASP Top 10 (2021) 檢查結果

| 項目 | 狀態 | 發現的問題 |
|-----|------|-----------|
| A01: Broken Access Control | [✅ / ⚠️ / ❌] | [數量] |
| A02: Cryptographic Failures | [✅ / ⚠️ / ❌] | [數量] |
| A03: Injection | [✅ / ⚠️ / ❌] | [數量] |
| A04: Insecure Design | [✅ / ⚠️ / ❌] | [數量] |
| A05: Security Misconfiguration | [✅ / ⚠️ / ❌] | [數量] |
| A06: Vulnerable Components | [✅ / ⚠️ / ❌] | [數量] |
| A07: Authentication Failures | [✅ / ⚠️ / ❌] | [數量] |
| A08: Data Integrity Failures | [✅ / ⚠️ / ❌] | [數量] |
| A09: Logging Failures | [✅ / ⚠️ / ❌] | [數量] |
| A10: SSRF | [✅ / ⚠️ / ❌] | [數量] |

### CWE Top 25 覆蓋率

已檢查的 CWE: [數量] / 25

---

## 修復優先級建議

### 立即修復 (Critical)

1. **[CRITICAL-001]**: [標題] - `[檔案:行號]`
2. **[CRITICAL-002]**: [標題] - `[檔案:行號]`

預估修復時間: [時間]

### 高優先級 (7 天內)

1. **[HIGH-001]**: [標題] - `[檔案:行號]`
2. **[HIGH-002]**: [標題] - `[檔案:行號]`

預估修復時間: [時間]

### 中優先級 (30 天內)

1. **[MEDIUM-001]**: [標題] - `[檔案:行號]`
2. **[MEDIUM-002]**: [標題] - `[檔案:行號]`

預估修復時間: [時間]

### 低優先級 (下個版本)

1. **[LOW-001]**: [標題] - `[檔案:行號]`

---

## 修復驗證計畫

### 測試環境

- [ ] 建立測試環境
- [ ] 部署修復程式碼
- [ ] 執行單元測試
- [ ] 執行整合測試
- [ ] 執行安全測試

### 驗證項目

| 問題編號 | 驗證方式 | 負責人 | 狀態 | 完成日期 |
|---------|---------|--------|------|---------|
| [ID] | [方式] | [人員] | [待處理/進行中/完成] | [日期] |

---

## 安全最佳實踐建議

### 短期建議 (1-3 個月)

1. **輸入驗證**
   - 實施統一的輸入驗證框架
   - 使用 Zod / validator 等型別安全的驗證套件
   - 在所有 API 端點實施驗證

2. **敏感資料管理**
   - 將所有硬編碼的密鑰移至環境變數
   - 考慮使用 AWS Secrets Manager / Azure Key Vault
   - 實施密鑰輪換機制

3. **安全配置**
   - 設定完整的 Security Headers
   - 實施嚴格的 CORS 政策
   - 確保所有 Cookie 都有安全屬性

### 中期建議 (3-6 個月)

1. **自動化安全測試**
   - 在 CI/CD 整合安全掃描
   - 實施 SAST (靜態應用程式安全測試)
   - 實施 DAST (動態應用程式安全測試)

2. **安全監控**
   - 實施安全事件日誌
   - 設定異常行為告警
   - 定期審查安全日誌

3. **安全訓練**
   - 團隊安全意識訓練
   - 安全編碼最佳實踐培訓
   - 定期進行安全演練

### 長期建議 (6-12 個月)

1. **安全架構**
   - 設計安全架構圖
   - 實施零信任安全模型
   - 建立威脅模型

2. **合規性**
   - 符合產業標準 (OWASP, CWE, NIST)
   - 取得安全認證 (如適用)
   - 定期安全稽核

---

## 資源與工具

### 推薦工具

- **SAST**: SonarQube, Semgrep, CodeQL
- **DAST**: OWASP ZAP, Burp Suite
- **依賴掃描**: Snyk, Dependabot, OWASP Dependency-Check
- **密鑰掃描**: TruffleHog, GitLeaks, detect-secrets

### 參考資源

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/)
- [CWE Top 25](https://cwe.mitre.org/top25/)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)
- [SANS Top 25](https://www.sans.org/top25-software-errors/)

---

## 附錄

### A. 掃描配置

```json
{
  "scan_type": "[全面掃描 / 快速掃描 / 客製化]",
  "included_paths": ["[路徑]"],
  "excluded_paths": ["[路徑]"],
  "rules": {
    "injection": true,
    "xss": true,
    "secrets": true,
    "dependencies": true,
    "config": true
  }
}
```

### B. 誤報清單

| 編號 | 檔案 | 行號 | 原因 | 核准人 | 日期 |
|-----|------|------|------|--------|------|
| [ID] | [檔案] | [行號] | [原因] | [人員] | [日期] |

### C. 變更歷史

| 版本 | 日期 | 變更內容 | 作者 |
|-----|------|---------|------|
| 1.0 | [日期] | 初始報告 | Claude Code |

---

## 聯絡資訊

**報告問題或回饋**:
- 專案負責人: [名稱]
- 安全團隊: [聯絡方式]
- Email: [Email]

---

**報告結束**

*本報告由 Claude Code Security Skills 自動產生*
*最後更新: [日期時間]*
